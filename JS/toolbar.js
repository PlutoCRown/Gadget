// ==UserScript==
// @name         ToolBar
// @namespace    http://tampermonkey.net/
// @version      0.3
// @description  try to take over the world!
// @author       You
// @match        *://*/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=tampermonkey.net
// @grant        none
// ==/UserScript==

(function () {
  "use strict";
  const FnList = [
    {
      icon: '<path d="M212.101706 1024c-9.464011 0-19.133761-1.851654-28.186293-5.554963A75.300608 75.300608 0 0 1 136.389619 948.287914V75.747268A75.62979 75.62979 0 0 1 266.005419 22.666512l599.935988 612.486089a75.300608 75.300608 0 0 1 15.636192 82.295745 75.15659 75.15659 0 0 1-69.745645 46.291358H491.084284L266.622637 1000.339973c-14.607495 15.430452-34.358474 23.454288-54.520931 23.454288z m1.851654-943.314988v862.665157l222.609993-233.719918c14.196016-14.813234 34.152735-23.454288 54.726671-23.454288H807.099949L213.95336 80.479273z" </path>',
      title: "Cursor",
      Fn: () => { },
    },
    {
      icon: '<path d="M1024 163.84m0 30.72l0 0q0 30.72-30.72 30.72l-143.36 0q-30.72 0-30.72-30.72l0 0q0-30.72 30.72-30.72l143.36 0q30.72 0 30.72 30.72ZM1024 1024m-30.72 0l0 0q-30.72 0-30.72-30.72l0-798.72q0-30.72 30.72-30.72l0 0q30.72 0 30.72 30.72l0 798.72q0 30.72-30.72 30.72ZM184.32 1024m-30.72 0l0 0q-30.72 0-30.72-30.72l0-143.36q0-30.72 30.72-30.72l0 0q30.72 0 30.72 30.72l0 143.36q0 30.72-30.72 30.72ZM1024 962.56m0 30.72l0 0q0 30.72-30.72 30.72l-839.68 0q-30.72 0-30.72-30.72l0 0q0-30.72 30.72-30.72l839.68 0q30.72 0 30.72 30.72ZM0 0m30.72 0l798.72 0q30.72 0 30.72 30.72l0 0q0 30.72-30.72 30.72l-798.72 0q-30.72 0-30.72-30.72l0 0q0-30.72 30.72-30.72ZM184.32 368.64m30.72 0l430.08 0q30.72 0 30.72 30.72l0 0q0 30.72-30.72 30.72l-430.08 0q-30.72 0-30.72-30.72l0 0q0-30.72 30.72-30.72ZM860.16 0m0 30.72l0 798.72q0 30.72-30.72 30.72l0 0q-30.72 0-30.72-30.72l0-798.72q0-30.72 30.72-30.72l0 0q30.72 0 30.72 30.72ZM61.44 0m0 30.72l0 798.72q0 30.72-30.72 30.72l0 0q-30.72 0-30.72-30.72l0-798.72q0-30.72 30.72-30.72l0 0q30.72 0 30.72 30.72ZM471.04 163.84m0 30.72l0 430.08q0 30.72-30.72 30.72l0 0q-30.72 0-30.72-30.72l0-430.08q0-30.72 30.72-30.72l0 0q30.72 0 30.72 30.72ZM0 798.72m30.72 0l798.72 0q30.72 0 30.72 30.72l0 0q0 30.72-30.72 30.72l-798.72 0q-30.72 0-30.72-30.72l0 0q0-30.72 30.72-30.72Z" </path>',
      title: "Copy",
      Fn: () => { },
    },
    {
      icon: '<path d="M197.282498 1024c-108.816873 0-197.282498-88.465626-197.282498-197.282498s88.465626-197.282498 197.282498-197.282499 197.282498 88.465626 197.282499 197.282499-88.465626 197.282498-197.282499 197.282498z m0-332.265261c-74.344352 0-134.982762 60.63841-134.982762 134.982763s60.63841 134.982762 134.982762 134.982762 134.982762-60.63841 134.982763-134.982762-60.63841-134.982762-134.982763-134.982763zM841.046441 1024c-108.816873 0-197.282498-88.465626-197.282499-197.282498s88.465626-197.282498 197.282499-197.282499 197.282498 88.465626 197.282498 197.282499-88.465626 197.282498-197.282498 197.282498z m0-332.265261c-74.344352 0-134.982762 60.63841-134.982762 134.982763s60.63841 134.982762 134.982762 134.982762 134.982762-60.63841 134.982762-134.982762-60.63841-134.982762-134.982762-134.982763zM992.946662-12.826581m22.026283 22.026283l0 0q22.026283 22.026283 0 44.052566l-675.472679 675.472679q-22.026283 22.026283-44.052566 0l0 0q-22.026283-22.026283 0-44.052566l675.472679-675.472679q22.026283-22.026283 44.052566 0ZM766.911192 706.715868m-22.026283 22.026283l0 0q-22.026283 22.026283-44.052566 0l-675.47268-675.472679q-22.026283-22.026283 0-44.052566l0 0q22.026283-22.026283 44.052566 0l675.47268 675.472679q22.026283 22.026283 0 44.052566Z" </path>',
      title: "Clip",
      Fn: () => { },
    },
    {
      icon: '<path d="M0 0m30.72 0l0 0q30.72 0 30.72 30.72l0 962.56q0 30.72-30.72 30.72l0 0q-30.72 0-30.72-30.72l0-962.56q0-30.72 30.72-30.72ZM1024 962.56m0 30.72l0 0q0 30.72-30.72 30.72l-962.56 0q-30.72 0-30.72-30.72l0 0q0-30.72 30.72-30.72l962.56 0q30.72 0 30.72 30.72ZM1024 1024m-30.72 0l0 0q-30.72 0-30.72-30.72l0-552.96q0-30.72 30.72-30.72l0 0q30.72 0 30.72 30.72l0 552.96q0 30.72-30.72 30.72ZM0 61.44m0-30.72l0 0q0-30.72 30.72-30.72l552.96 0q30.72 0 30.72 30.72l0 0q0 30.72-30.72 30.72l-552.96 0q-30.72 0-30.72-30.72ZM562.189194 525.63656m-21.72232-21.72232l0 0q-21.72232-21.72232 0-43.444641l391.001765-391.001765q21.72232-21.72232 43.444641 0l0 0q21.72232 21.72232 0 43.44464l-391.001766 391.001766q-21.72232 21.72232-43.44464 0Z" </path>',
      title: "Write",
      Fn: () => { },
    },
    {
      icon: '<path d="M491.52 0m40.96 0l0 0q40.96 0 40.96 40.96l0 942.08q0 40.96-40.96 40.96l0 0q-40.96 0-40.96-40.96l0-942.08q0-40.96 40.96-40.96ZM1024 450.56m0 40.96l0 0q0 40.96-40.96 40.96l-942.08 0q-40.96 0-40.96-40.96l0 0q0-40.96 40.96-40.96l942.08 0q40.96 0 40.96 40.96Z" </path>',
      title: "Add",
      Fn: () => { },
    },
    {
      icon: '<path d="M886.873043 1024H295.624348L0 512 295.624348 0h591.248695l295.624348 512-295.624348 512z m-552.737391-66.782609H848.13913l257.113044-445.217391L848.361739 66.782609h-514.226087L77.022609 512l257.113043 445.217391z" </path>',
      title: "Close",
      Fn: parent => {
        parent.remove();
      },
    },
  ];
  const css = `   
        .toolbar {
            height: ${(FnList.length + 1) * 2.7}em;
            background-color:#8970fa;
            max-height: 60vh;
            position: fixed;
            border-radius: 10px;
            z-index: 1000000;
            border: 2px solid  #765bf1;
            display: flex;
            flex-direction: column;
            justify-content: start;
            align-items: center;
            padding: 10px;
            top: 20px;
            left: 20px;
            overflow: scroll;

        }
        .toolbar::-webkit-scrollbar {
            width: 0;
        }
        .icon {
            width: 1.7em;
            flex-shrink: 0;
            height: 1.7em;
            fill: #ded6ff;
            margin-bottom: 1em;
            cursor: pointer;
        }
        .icon:hover {
            fill: #FFF;
        }
        .toolbar-handle {
            cursor: grab !important;
        }
    `;
  const HTML = `
    <div class="toolbar">
        <a title="Move" class="icon toolbar-handle">
            <svg viewBox="0 0 1182 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <path d="M485.09015 623.916464m26.731639 0l0 0q26.731639 0 26.731639 26.731639l0 302.780369q0 26.731639-26.731639 26.731639l0 0q-26.731639 0-26.731639-26.731639l0-302.780369q0-26.731639 26.731639-26.731639ZM285.095994 808.333315m18.902123-18.902123l0 0q18.902123-18.902123 37.804247 0l188.895221 188.895221q18.902123 18.902123 0 37.804247l0 0q-18.902123 18.902123-37.804247 0l-188.895221-188.895221q-18.902123-18.902123 0-37.804247ZM700.848102 770.454356m18.902123 18.902123l0 0q18.902123 18.902123 0 37.804247l-188.895221 188.895221q-18.902123 18.902123-37.804247 0l0 0q-18.902123-18.902123 0-37.804247l188.895221-188.895221q18.902123-18.902123 37.804247 0ZM980.160111 485.09015m0 26.731639l0 0q0 26.731639-26.731639 26.731639l-302.780369 0q-26.731639 0-26.731639-26.731639l0 0q0-26.731639 26.731639-26.731639l302.780369 0q26.731639 0 26.731639 26.731639ZM1034.946735 511.957118m-18.902123 18.902124l0 0q-18.902123 18.902123-37.804247 0l-188.895221-188.895221q-18.902123-18.902123 0-37.804247l0 0q18.902123-18.902123 37.804247 0l188.895221 188.895221q18.902123 18.902123 0 37.804247ZM997.308469 474.217756m18.902123 18.902124l0 0q18.902123 18.902123 0 37.804247l-188.89522 188.895221q-18.902123 18.902123-37.804247 0l0 0q-18.902123-18.902123 0-37.804247l188.89522-188.895221q18.902123-18.902123 37.804247 0ZM43.839889 538.90985m0-26.731639l0 0q0-26.731639 26.731639-26.731639l302.780369 0q26.731639 0 26.731639 26.731639l0 0q0 26.731639-26.731639 26.731639l-302.780369 0q-26.731639 0-26.731639-26.731639ZM-11.164017 512.147646m18.902123-18.902123l0 0q18.902123-18.902123 37.804247 0l188.895221 188.895221q18.902123 18.902123 0 37.804247l0 0q-18.902123 18.902123-37.804247 0l-188.895221-188.895221q-18.902123-18.902123 0-37.804247ZM26.801886 549.98782m-18.902123-18.902124l0 0q-18.902123-18.902123 0-37.804247l188.895221-188.895221q18.902123-18.902123 37.804247 0l0 0q18.902123 18.902123 0 37.804247l-188.895221 188.895221q-18.902123 18.902123-37.804247 0ZM538.90985 400.083536m-26.731639 0l0 0q-26.731639 0-26.731639-26.731639l0-302.780369q0-26.731639 26.731639-26.731639l0 0q26.731639 0 26.731639 26.731639l0 302.780369q0 26.731639-26.731639 26.731639ZM738.656302 215.777935m-18.776109 18.77611l-0.252029 0.252028q-18.776109 18.776109-37.552218 0l-189.14725-189.147249q-18.776109-18.776109 0-37.552219l0.252029-0.252028q18.776109-18.776109 37.552218 0l189.14725 189.147249q18.776109 18.776109 0 37.552219ZM323.168824 253.445729m-18.77611-18.77611l-0.252028-0.252028q-18.776109-18.776109 0-37.552219l189.147249-189.147249q18.776109-18.776109 37.552219 0l0.252028 0.252029q18.776109 18.776109 0 37.552218l-189.147249 189.147249q-18.776109 18.776109-37.552219 0Z" p-id="847"></path>
            </svg>
        </a>
        ${FnList.map(
    i => `
                <a title="${i.title}" id="${i.title}">
                    <svg  class="icon" viewBox="0 0 1182 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        ${i.icon}
                    </svg>
                </a>
            `
  ).reduce((str, item) => str + item, "")}
    </div>
    `;
  const domParser = new DOMParser();
  const DOM = domParser.parseFromString(HTML, "text/html");
  const styleTag = document.createElement("style");
  styleTag.innerHTML = css;
  setTimeout(() => {
    document.body.appendChild(DOM.querySelector(".toolbar"));
    document.head.appendChild(styleTag);
    (() => {
      const draggables = document.querySelectorAll(".toolbar");
      draggables.forEach(draggable => {
        const handle = draggable.querySelector(".toolbar-handle");
        handle.addEventListener("mousedown", event => {
          function normalDrag(element) {
            const offsetX = element.clientX - startX;
            const offsetY = element.clientY - startY;
            draggable.style.left = originalX + offsetX + "px";
            draggable.style.top = originalY + offsetY + "px";
          }
          event.preventDefault();
          const startX = event.clientX;
          const startY = event.clientY;
          const originalX = draggable.offsetLeft;
          const originalY = draggable.offsetTop;
          document.addEventListener("mousemove", normalDrag);
          document.addEventListener("mouseup", () => {
            document.removeEventListener("mousemove", normalDrag);
          });
        });
        FnList.forEach(i => draggable.querySelector(`#${i.title}`)?.addEventListener("click", () => i.Fn(draggable)))

      });
    })();
  }, 0);
})();
